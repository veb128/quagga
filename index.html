<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ZXing UPC Scanner</title>
  <style>
    #video {
      width: 100%;
      max-width: 600px;
      border: 2px solid #333;
    }
    #output {
      margin-top: 20px;
      text-align: center;
      font-size: 1.2em;
    }
  </style>
</head>
<body>
  <h1 style="text-align:center;">ZXing UPC Scanner (No Modules/Filtered)</h1>
  <video id="video" autoplay></video>
  <div id="output">Initializing scanner...</div>

  <!-- Load ZXing UMD build -->
  <script src="https://unpkg.com/@zxing/library@0.18.6/umd/index.min.js"></script>
  <script>
    const codeReader = new ZXing.BrowserMultiFormatReader();
    const output = document.getElementById('output');
    const videoElement = document.getElementById('video');

    codeReader
      .listVideoInputDevices()
      .then(videoInputDevices => {
        if (videoInputDevices.length === 0) {
          output.textContent = "No camera found.";
          return;
        }
        const backFacing = videoInputDevices.filter(vid => vid.facing === 'back');
        alert(JSON.stringify(backFacing));
        const deviceId = videoInputDevices[0].deviceId;
        codeReader.decodeOnceFromVideoDevice(deviceId, videoElement)
          .then(result => {
            output.textContent = `Scanned Code: ${result.text}`;
          })
          .catch(err => {
            console.error(err);
            output.textContent = `Error: ${err.message}`;
          });
      })
      .catch(err => {
        console.error(err);
        output.textContent = `Camera Error: ${err.message}`;
      });
  </script>
</body>
</html>